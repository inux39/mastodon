<source>
    @type tail
    path /var/log/nginx/don-access.log
    pos_file /var/tmp/fluentd/don-access.log.pos
    tag nginx.don.access
    <parse>
        @type nginx
    </parse>
</source>

<source>
    @type tail
    path /var/log/nginx/image-access.log
    pos_file /var/tmp/fluentd/image-access.log.pos
    tag nginx.image-don.access
    <parse>
        @type nginx
    </parse>
</source>

<source>
    @type tail
    path /var/log/nginx/don-error.log
    pos_file /var/tmp/fluentd/don-error.log.pos
    tag nginx.don.error

    format multiline
    format_firstline /^\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2} \[\w+\] (?<pid>\d+).(?<tid>\d+): /
    format1 /^(?<time>\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2}) \[(?<log_level>\w+)\] (?<pid>\d+).(?<tid>\d+): (?<message>.*)/
</source>

<source>
    @type tail
    path /var/log/nginx/image-error.log
    pos_file /var/tmp/fluentd/image-error.log.pos
    tag nginx.image-don.error

    format multiline
    format_firstline /^\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2} \[\w+\] (?<pid>\d+).(?<tid>\d+): /
    format1 /^(?<time>\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2}) \[(?<log_level>\w+)\] (?<pid>\d+).(?<tid>\d+): (?<message>.*)/
</source>

<match nginx.**>
    @type forward
    <server>
        host 192.168.100.110
        port 24224
    </server>
    <buffer>
        @type file
        path /var/tmp/fluentd
        flush_interval 15s
    </buffer>
</match>

